# 2.3 亚克星上的军队

## 实验任务

亚克星上住着许多神奇的生物。其中有聪慧的人族、优雅的精灵、彪悍的野蛮猪、粗鲁的首任驻….有一天，住在湛蓝球上的恶魔们突破空间的封锁入侵这个美丽的星球。为了保卫共同的家园，亚克星各族不得不摒弃前嫌，组成联盟。为了更有利的反击恶魔们的入侵，他们建立了统一的军事指挥中心。在前期，指挥中心会不停的发布军队调动命令，可是，麻烦来了。为了更好的做出决策，指挥中心必须迅速了解己方的各地区的军事力量详情。你能否帮帮这些可怜的种族呢？

每个地区有一个编号（从 1 到 N），如果一个地区有军队的话，这些军队将组成一个军团。指挥中心将发布的命令如下：

- U a b:将 b 地区军团的调到 a 地区，从而组成一个新的军团。为了便于管理，每次新加入的军队将按顺序加入到 a 军团后面。数据保证 a 与 b 不相同。
- I a x:将一支人数为 x的军队调到 a 地区。为了便于管理，每次新加入的军队将加入到a军团前面。
- D a x:将 a 地区中军队人数为x 的调走。若不存在，则不执行。
- Q a：询问 a 地区的具体军事信息（即按顺序输出该军团中每个军队的人数）。

## 数据输入

输入第一行为两个正整数 N ,M(2 <= N,M <= 1000)。

接下来 N 行，每行第一个数 K 表示该地区军队的个数 K(1<=K<=100)，接下来 K 个数,表示各个军队的人数信息(0<=ai<2^31)。

接下来 M 行，每行一个操作。

## 数据输出

对于每个询问操作，输出一行表示 a 地区具体军事信息，每两个数之间空格隔开,，行末无空格。若 a 内无元素，输出-1。

## 输入示例

```cpp
3 9
2 1 2
3 1 2 3
4 3 2 1 3
U 1 2
Q 1
Q 2
U 3 1
Q 3
I 1 1
Q 1
D 3 1
Q 3
```

## 输出示例

```cpp
1 2 1 2 3
-1
3 2 1 3 1 2 1 2 3
1
3 2 3 2 2 3
```

## 代码

```cpp
#include <bits/stdc++.h>
using namespace std;
using ll = long long;

int main() {
    ios::sync_with_stdio(0);
    cin.tie(0);

    int N, M;
    if (!(cin >> N >> M)) return 0;
    vector<deque<ll>> g(N + 1);
    for (int i = 1; i <= N; i++) {
        int K; cin >> K;
        for (int j = 0; j < K; j++) {
            ll x; cin >> x;
            g[i].push_back(x);
        }
    }
    for (int i = 0; i < M; i++) {
        char op; cin >> op;
        if (op == 'U') {
            int a, b; cin >> a >> b;
            if (a != b && !g[b].empty()) {
                g[a].insert(g[a].end(), g[b].begin(), g[b].end());
                g[b].clear();
            }
        } else if (op == 'I') {
            int a; ll x; cin >> a >> x;
            g[a].push_front(x);
        } else if (op == 'D') {
            int a; ll x; cin >> a >> x;
            if (!g[a].empty()) {
                deque<ll> t;
                t.clear();
                for (ll v : g[a]) if (v != x) t.push_back(v);
                g[a].swap(t);
            }
        } else if (op == 'Q') {
            int a; cin >> a;
            if (g[a].empty()) {
                cout << -1 << '\n';
            } else {
                for (size_t j = 0; j < g[a].size(); j++) {
                    if (j) cout << ' ';
                    cout << g[a][j];
                }
                cout << '\n';
            }
        }
    }
    return 0;
}
```

[返回目录](../README.md)
